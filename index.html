<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Treblle ROI Estimator</title>
<link rel="icon" type="image/png" href="treblle-favicon.png">
<meta name="description" content="Calculate your ROI with Treblle — see time and cost savings instantly.">
<meta property="og:title" content="Treblle ROI Estimator">
<meta property="og:description" content="Calculate your ROI with Treblle — see time and cost savings instantly.">
<meta property="og:image" content="treblle-roi-preview.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="color-scheme" content="dark">
<style>
  :root{
    /* Treblle Brand Colors - Complete Token System */
    color-scheme: dark;
    --treblle-midnight: #01041A;
    --treblle-obsidian: #14182F;
    --treblle-primary: #0058FF;
    --treblle-electric-200: #4A90E2;
    --treblle-electric-100: #6BA6F0;
    --treblle-element-200: rgba(130,150,180,.3);
    --treblle-element-300: rgba(130,150,180,.5);
    --treblle-fog: #E6EEFC;
    --treblle-white: #FFFFFF;
    --treblle-ruby-200: #ef4444;
    --treblle-garden-200: #16c784;
    
    /* Design System Tokens */
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 18px;
    --radius-full: 999px;
    
    --shadow-card: 0 10px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.04);
    --shadow-card-hover: 0 20px 60px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.06);
    --shadow-btn: 0 4px 12px rgba(0,0,0,.2);
    --shadow-btn-primary: 0 4px 16px rgba(0,88,255,.3);
    --shadow-focus: 0 0 0 3px var(--treblle-electric-100);
    
    --spacing-xs: 4px;
    --spacing-sm: 8px;
    --spacing-md: 12px;
    --spacing-lg: 16px;
    --spacing-xl: 24px;
    
    /* Theme Variables */
    --bg: var(--treblle-midnight);
    --surface: var(--treblle-obsidian);
    --surface-card: var(--treblle-obsidian);
    --surface-field: #1B2344;
    --panel: var(--treblle-obsidian);
    --muted: #8aa0be;
    --text: var(--treblle-fog);
    --text-heading: var(--treblle-white);
    --text-secondary: #D6E2FF;
    --primary: var(--treblle-primary);
    --accent: var(--treblle-electric-200);
    --good: var(--treblle-garden-200);
    --warn: #f59e0b;
    --bad: var(--treblle-ruby-200);
    --border: var(--treblle-element-200);
    --ring: var(--treblle-electric-100);
    --glass: rgba(255,255,255,.04);
    
    /* Opaque secondary for dark surfaces; tuned for legibility next to fields */
    --text-fieldnote: #D6E2FF;
    --brand-logo-size: 42px; /* adjust 38–44px to taste */
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    color:var(--text);
    background: linear-gradient(180deg, var(--treblle-midnight) 0%, var(--treblle-obsidian) 100%);
    background-attachment: fixed;
    font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
    line-height:1.6;
    font-weight:400;
    font-synthesis:none;
    text-rendering:optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-text-size-adjust: 100%;
  }
  body::before{
    content:"";
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:-1;
    background:
      radial-gradient(1000px 600px at 20% -10%, rgba(255,255,255,.05), transparent 60%),
      radial-gradient(1200px 700px at 80% 0%, rgba(106,166,240,.08), transparent 55%);
  }
  /* Layout & Responsive Container */
  .wrap{
    max-width:1024px;
    margin:var(--spacing-xl) auto;
    padding:0 var(--spacing-lg);
    width:100%;
  }
  @media (max-width: 768px){
    .wrap{padding:0 var(--spacing-md);margin:var(--spacing-lg) auto}
  }
  @media (max-width: 480px){
    .wrap{padding:0 var(--spacing-sm)}
  }
  
  /* Header */
  header{margin-bottom:var(--spacing-xl)}
  .header-brand{margin-bottom:var(--spacing-md)}
  .header-brand img{height:40px;display:block}
  .header-content{margin-top:12px}
  .header-content h1{margin:0;font-size:clamp(24px,4vw,36px);font-weight:800;letter-spacing:.2px;color:var(--text-heading)}
  .header-content .sub{margin:var(--spacing-xs) 0 0;color:var(--muted);font-size:16px;line-height:1.4}
  
  /* Video Card */
  .video-card {
    background: rgba(20, 24, 47, 0.4);
    border: 1px solid rgba(130, 150, 180, 0.2);
    border-radius: 16px;
    padding: 12px;
    margin: 24px auto;
    max-width: 620px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.25);
    backdrop-filter: blur(10px);
  }
  
  /* Grid Layout */
  .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:var(--spacing-xl)}
  @media (max-width: 980px){.grid{grid-template-columns:1fr;gap:var(--spacing-xl)}}
  @media (max-width: 768px){.grid{gap:var(--spacing-xl)}}
  @media (max-width: 420px){
    .grid{gap:calc(var(--spacing-xl) * 1.5)}
    .stack{flex-direction:column}
    .btn{width:100%}
    .kpi-subtext,.result-subtext,.kpi-caption,.currency-subtext{font-size:14px}
  }
  /* Card Primitive */
  .card{
    background: var(--surface-card);
    border:1px solid var(--treblle-element-300);
    border-radius:var(--radius-xl);
    padding:var(--spacing-lg);
    box-shadow: 0 2px 10px rgba(0,0,0,.40);
    position:relative;
    overflow:clip;
    transition: box-shadow 180ms ease;
  }
  .card:hover{
    box-shadow: 0 6px 20px rgba(0,0,0,.60);
  }
  .card:before{content:"";position:absolute; inset:-1px;border-radius:var(--radius-xl);background: radial-gradient(600px 120px at 20% -40px, var(--ring), transparent 60%);pointer-events:none;opacity:.5}
  .card h2{margin:0 0 var(--spacing-sm);font-size:clamp(16px,2.1vw,20px);color:var(--text-heading);font-weight:700}
  .section{display:flex;align-items:center;gap:8px;margin:22px 0 10px;color:var(--treblle-white);font-weight:700;font-size:14px;letter-spacing:0;text-transform:none;line-height:1.2}
  .section::before{content:"";width:3px;height:14px;border-radius:2px;background:var(--treblle-electric-200);box-shadow:0 0 12px rgba(74,144,226,.45)}
  .row{display:grid;grid-template-columns:1.3fr .7fr .7fr;gap:10px;padding:var(--spacing-sm) 0;align-items:center;margin-bottom:var(--spacing-lg)}
  .row label{color:var(--treblle-element-300);font-weight:600;font-size:13px;letter-spacing:.2px;text-transform:none;margin-bottom:6px}
  .row input,.row select{width:100%;min-height:42px;padding:11px 12px;border-radius:12px;border:1px solid var(--treblle-element-300);background:var(--surface-field);color:var(--treblle-fog);outline:none;transition:all .15s}
  .row input::placeholder{color:var(--treblle-element-300)}
  .row input:hover,.row select:hover{border-color:var(--treblle-element-200)}
  .row input:focus,.row select:focus{box-shadow:0 0 0 3px var(--ring);border-color:var(--treblle-electric-200);background:var(--surface)}
  .row input:invalid{border-color:var(--bad);box-shadow:0 0 0 1px var(--bad)}
  .row input.error{border-color:var(--bad);box-shadow:0 0 0 2px rgba(239,68,68,.2)}
  .row input.success{border-color:var(--good);box-shadow:0 0 0 2px rgba(22,199,132,.2)}
  .row input[type=number]{text-align:right}
  .hint{color:var(--muted);font-size:12px}
  .stack{display:flex;gap:10px;flex-wrap:wrap}
  .btn{border:1px solid var(--border);background:var(--treblle-obsidian);color:var(--treblle-fog);padding:10px 14px;border-radius:12px;cursor:pointer;transition:all .15s;position:relative;overflow:hidden}
  .btn:hover{opacity:0.9;transform:translateY(-1px);box-shadow:0 4px 12px rgba(0,0,0,.2)}
  .btn:focus{outline:none;box-shadow:0 0 0 3px var(--treblle-electric-100)}
  .btn.primary{background:var(--treblle-primary);color:var(--treblle-white);font-weight:800;border:none}
  .btn.primary:hover{background:var(--treblle-electric-200);transform:translateY(-1px);box-shadow:0 4px 16px rgba(0,88,255,.3)}
  .btn.primary:focus{box-shadow:0 0 0 3px var(--treblle-electric-100)}
  .btn.primary:active{transform:translateY(1px);box-shadow:0 2px 8px rgba(0,88,255,.2)}
  .btn:disabled{opacity:0.5;cursor:not-allowed;transform:none;box-shadow:none}
  .btn.loading{cursor:not-allowed}
  .btn.loading::after{content:'';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:16px;height:16px;border:2px solid transparent;border-top:2px solid currentColor;border-radius:50%;animation:spin 1s linear infinite}
  @keyframes spin{0%{transform:translate(-50%,-50%) rotate(0deg)}100%{transform:translate(-50%,-50%) rotate(360deg)}}
  .summary{display:grid;grid-template-columns: repeat(2, minmax(0,1fr));gap:14px}
  .kpi{background:var(--treblle-obsidian);border:1px solid var(--border);border-radius:16px;padding:14px;display:flex;flex-direction:column;gap:2px}
  .kpi h3{margin:0;color:#cbd5e1;font-size:13px}
  .kpi .val{font-size:clamp(20px,3.3vw,30px);font-weight:900}
  .kpi .trend{font-size:12px;color:var(--muted)}
  .kpi-subtext,.result-subtext,.kpi-caption,.currency-subtext{color:var(--text-secondary);font-size:clamp(13px,1.65vw,15px);line-height:1.35;letter-spacing:.1px;font-weight:500;opacity:1 !important;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
  .result-value,.kpi-value,.currency{text-align:right;font-variant-numeric:tabular-nums}
  .mono{font-variant-numeric:tabular-nums;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace}
  .badges{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
  .badge{font-size:12px;padding:6px 8px;border-radius:999px;border:1px solid var(--border);background:var(--treblle-obsidian);color:var(--treblle-fog)}
  .impact{display:grid;grid-template-columns:1fr;gap:10px;margin-top:8px}
  .impactCard{display:grid;grid-template-columns:48px 1fr auto;gap:14px;align-items:center;background:linear-gradient(180deg,rgba(135,207,255,.06),rgba(255,255,255,.02));border:1px solid var(--treblle-element-300);border-radius:16px;padding:12px 14px;transition: all 0.2s ease}
  .impactCard:hover{background:linear-gradient(180deg,rgba(135,207,255,.1),rgba(255,255,255,.04));border-color:var(--treblle-element-200);transform:translateY(-1px)}
  .icon{width:48px;height:48px;border-radius:12px;display:grid;place-items:center;background:radial-gradient(220px 90px at 120% -10%, rgba(90,200,250,.25), transparent 60%),#0a1422;border:1px solid var(--treblle-element-300)}
  .icon svg{width:24px;height:24px;opacity:.9}
  .impTitle{font-weight:700;color:var(--treblle-fog)}
  .beforeAfter{font-size:14px;color:var(--text-secondary);opacity:1;font-weight:500;line-height:1.35;letter-spacing:.1px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
  .deltaPct{font-weight:900;color:var(--good);font-size:clamp(16px,2.4vw,22px);text-align:right}
  .deltaMoney{font-size:14px;color:var(--text-secondary);text-align:right;font-weight:500;line-height:1.35;letter-spacing:.1px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
  .bar{position:relative;height:8px;background:#081122;border-radius:999px;overflow:hidden;margin-top:7px}
  .bar>span{position:absolute;inset:0 100% 0 0;background:linear-gradient(90deg, var(--primary), var(--accent))}
  .drivers{display:grid;grid-template-columns:repeat(3, minmax(0,1fr));gap:10px;margin-top:10px}
  @media (max-width:520px){.drivers{grid-template-columns:1fr}}
  .driver{background:var(--treblle-obsidian);border:1px solid var(--border);border-radius:14px;padding:12px}
  .driver .name{color:#cbd5e1;font-size:12px;margin-bottom:4px}
  .driver .amt{font-weight:800}
  /* small disclaimer style */
  .disclaimer{margin-top:6px;color:var(--muted);font-size:12px}
  
  /* Footer */
  footer{margin-top:calc(var(--spacing-xl) * 2);padding:var(--spacing-lg) 0;text-align:center;border-top:1px solid var(--treblle-element-200);color:var(--treblle-element-300);font-size:13px;font-weight:500}
  footer a{color:var(--treblle-electric-200);text-decoration:none}
  footer a:hover{text-decoration:underline}
  
  /* ---- Left Inputs panel: high-contrast notes & placeholders ---- */
  
  .pane-inputs .field-note,
  .pane-inputs small.field-note {
    color: var(--text-fieldnote);
    font-size: clamp(13px, 1.6vw, 15px);
    line-height: 1.35;
    letter-spacing: 0.1px;
    font-weight: 500;
    opacity: 1; /* ensure no prior rules fade it */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  /* Placeholders like "Optional" inside inputs — readable, not washed out */
  .pane-inputs input::placeholder,
  .pane-inputs textarea::placeholder {
    color: var(--text-fieldnote);
    opacity: 1;
    font-weight: 500;
  }
  
  /* Keep rows tidy so notes don't feel cramped */
  .pane-inputs .row { margin-bottom: 16px; }
  
  /* Larger logo */
  .header-brand img { height: var(--brand-logo-size); display: block; }
  .header-brand + .header-content { margin-top: 12px; }
  
  /* Error and Loading States */
  .error-message{background:rgba(239,68,68,.1);border:1px solid var(--bad);border-radius:8px;padding:8px 12px;margin-top:8px;font-size:13px;color:var(--bad);display:none}
  .error-message.show{display:block}
  .loading-state{display:flex;align-items:center;gap:8px;font-size:13px;color:var(--muted);margin-top:8px}
  .loading-state .spinner{width:16px;height:16px;border:2px solid var(--treblle-element-300);border-top:2px solid var(--treblle-electric-200);border-radius:50%;animation:spin 1s linear infinite}
  .empty-state{text-align:center;padding:40px 20px;color:var(--muted);font-size:14px}
  .empty-state svg{width:48px;height:48px;opacity:0.5;margin-bottom:16px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="header-brand">
      <img src="treblle-logo.svg" alt="Treblle" />
    </div>
    <div class="header-content" style="text-align: center;">
      <h1>Treblle Enterprise: ROI Estimator</h1>
      
      <div class="video-card">
        <video width="100%" height="300" autoplay muted loop playsinline preload="auto" style="border-radius: 12px;">
          <source src="demo-video-treblle.mp4" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
      
      <p class="sub">Estimate your API time-savings, net value, ROI multiple, and payback - based on your inputs.</p>
      <div class="disclaimer">This tool provides operational efficiency estimates only. Results depend on your inputs and model assumptions; actual outcomes may vary.</div>
    </div>
  </header>

  <div class="grid">
    <div class="card pane-inputs">
      <h2>Inputs</h2>
      <div class="badges">
        <div class="badge">Conservative adjustment applied to benefits</div>
        <div class="badge">SaaS $2,999/mo · Private $5,998/mo</div>
        <div class="badge">Base includes 25 Production APIs</div>
      </div>

      <div class="section">Company & Traffic</div>
      <div class="row"><label for="company">Company name</label><input id="company" placeholder="Optional" /><div></div></div>
      <div class="row"><label for="annualRequests">Annual API requests</label><input id="annualRequests" type="number" value="300000000" class="mono"/><div class="hint"><small class="field-note">For context only</small></div></div>
      <div class="row"><label for="monthlyGrowth">Monthly API growth (%)</label><input id="monthlyGrowth" type="number" value="10" step="0.1" class="mono"/><div></div></div>
      <div class="row"><label for="numAPIs">Production APIs (count)</label><input id="numAPIs" type="number" value="25" min="1" step="1" class="mono"/><div class="hint"><small class="field-note">Base includes 25</small></div></div>
      <div class="row"><label for="numConsumers">API consumers / partners (count)</label><input id="numConsumers" type="number" value="1000" min="0" step="1" class="mono"/><div></div></div>

      <div class="section">Support & Engineering Baseline</div>
      <div class="row"><label for="ticketsPerMonth">Support tickets per month (all)</label><input id="ticketsPerMonth" type="number" value="200" class="mono"/><div></div></div>
      <div class="row"><label for="pctApiTickets">% of tickets that are API-related</label><input id="pctApiTickets" type="number" value="70" step="0.1" class="mono"/><div></div></div>
      <div class="row"><label for="pctEscalated">% of API tickets escalated to engineering</label><input id="pctEscalated" type="number" value="30" step="0.1" class="mono"/><div></div></div>
      <div class="row"><label for="hrsSupportPerTicket">Avg Support time per API ticket (hours)</label><input id="hrsSupportPerTicket" type="number" value="0.5" step="0.01" class="mono"/><div></div></div>
      <div class="row"><label for="hrsEngPerEscalation">Avg Engineering time per escalated ticket (hours)</label><input id="hrsEngPerEscalation" type="number" value="1.0" step="0.01" class="mono"/><div></div></div>
      <div class="row"><label for="rateSupport">Hourly loaded cost - Support ($)</label><input id="rateSupport" type="number" value="45" class="mono"/><div></div></div>
      <div class="row"><label for="rateEng">Hourly loaded cost - Engineering ($)</label><input id="rateEng" type="number" value="85" class="mono"/><div></div></div>

      <div class="section">Analysis & Governance</div>
      <div class="row"><label>Weekly hours on customer pattern analysis (team total)</label><input id="weeklyPatternHours" type="number" value="20" step="0.1" class="mono"/><div></div></div>
      <div class="row"><label>Hourly loaded cost - Analytics/PM ($)</label><input id="rateAnalytics" type="number" value="70" class="mono"/><div></div></div>
      <div class="row"><label>Gateway/SQL manual query hours per month</label><input id="azureHours" type="number" value="40" step="0.1" class="mono"/><div></div></div>

      <div class="section">Customer & Revenue</div>
      <div class="row"><label>Customers / partners (count)</label><input id="customers" type="number" value="2000" class="mono"/><div></div></div>
      <div class="row"><label>Average customer annual value ($)</label><input id="arpa" type="number" value="1500" class="mono"/><div></div></div>
      <div class="row"><label>Retention risk due to analytics gap (%)</label><input id="retentionRisk" type="number" value="1.0" step="0.1" class="mono"/><div></div></div>

      <div class="section">Compliance & Alternative Tooling</div>
      <div class="row"><label>Compliance FTEs avoided (count)</label><input id="complianceFTE" type="number" value="0" step="0.1" class="mono"/><div></div></div>
      <div class="row"><label>FTE fully loaded cost ($/year)</label><input id="fteCost" type="number" value="120000" class="mono"/><div></div></div>
      <div class="row"><label>Alternative monitoring/tooling cost avoided ($/year)</label><input id="altTooling" type="number" value="0" class="mono"/><div></div></div>
      <div class="row"><label>Developer portal license savings ($/year)</label><input id="devPortalSavings" type="number" value="0" class="mono"/><div></div></div>

      <div class="section">Assumptions & Deployment</div>
      <div class="row"><label>Conservatism factor (%)</label><input id="confidence" type="number" value="80" step="1" class="mono"/><div class="hint"><small class="field-note">Applies a discount to benefits</small></div></div>
      <div class="row"><label>Deployment</label>
        <select id="deployment"><option value="SaaS" selected>SaaS</option><option value="Private">Private</option></select>
        <div class="hint"><small class="field-note">Override value bypasses estimator</small></div>
      </div>
      <div class="row"><label>Treblle annual cost (override)</label><input id="override" type="number" placeholder="Leave blank to auto-estimate" class="mono"/><div></div></div>
      <div class="row"><label>Customer communication per ticket (hours)</label><input id="commsHoursPerTicket" type="number" value="0.25" step="0.01" class="mono"/><div></div></div>
      <div class="row"><label>Currency</label>
        <select id="currency"><option>USD</option><option>EUR</option><option>GBP</option><option>SEK</option><option>NOK</option></select>
        <div></div>
      </div>

      <div class="stack" style="margin-top:10px">
        <button class="btn" id="resetBtn">Reset defaults</button>
        <button class="btn primary" id="recalcBtn">Calculate</button>
      </div>

      <details style="margin-top:12px">
        <summary>Model assumptions &amp; pricing (optional)</summary>
        <div class="section">Benchmarks</div>
        <div class="row"><label>Support time reduction per API ticket (%)</label><input id="bmSupport" type="number" value="68.7" step="0.1" class="mono"/><div></div></div>
        <div class="row"><label>Engineering time reduction per escalated ticket (%)</label><input id="bmEng" type="number" value="86.9" step="0.1" class="mono"/><div></div></div>
        <div class="row"><label>Customer comms overhead reduction (%)</label><input id="bmComms" type="number" value="94.2" step="0.1" class="mono"/><div></div></div>
        <div class="row"><label>Gateway/SQL manual query time reduction (%)</label><input id="bmAzure" type="number" value="90.0" step="0.1" class="mono"/><div></div></div>

        <div class="section">Pricing (auto-estimate when override is blank)</div>
        <div class="row"><label>SaaS base ($/yr)</label><input id="pSaaSBase" type="number" value="35988" class="mono"/><div class="hint"><small class="field-note">$2,999/mo</small></div></div>
        <div class="row"><label>SaaS add-on pack 25 APIs (annual)</label><input id="pSaaS25" type="number" value="10800" class="mono"/><div class="hint"><small class="field-note">+1B req</small></div></div>
        <div class="row"><label>Private Cloud base ($/yr)</label><input id="pPrivBase" type="number" value="71976" class="mono"/><div class="hint"><small class="field-note">$5,998/mo</small></div></div>
        <div class="row"><label>Private Cloud per-API (beyond 25) ($/yr)</label><input id="pPrivPerAPI" type="number" value="360" class="mono"/><div class="hint"><small class="field-note">$30/API/mo</small></div></div>
      </details>
    </div>

    <div class="card" aria-live="polite">
      <h2>Results</h2>

      <div class="summary">
        <div class="kpi">
          <h3>Gross benefit (conservatism applied)</h3>
          <div class="val mono" id="outBenefit">$0</div>
          <div class="trend" id="hoursSaved">Annual hours saved: 0</div>
        </div>
        <div class="kpi">
          <h3>Estimated Treblle cost</h3>
          <div class="val mono" id="outCost">$0</div>
          <div class="trend" id="deploymentNote">SaaS estimator</div>
        </div>
        <div class="kpi">
          <h3>Net annual value</h3>
          <div class="val mono" id="outNet">$0</div>
          <div class="trend">Conservatism: <span id="outConf">80%</span></div>
        </div>
        <div class="kpi">
          <h3>ROI multiple (x)</h3>
          <div class="val mono" id="outROI">n/a</div>
          <div class="trend">Based on conservatively adjusted benefit</div>
        </div>
        <div class="kpi">
          <h3>Payback period (months)</h3>
          <div class="val mono" id="outPaybackKPI">n/a</div>
          <div class="trend">12 × cost / benefit</div>
        </div>
      </div>

      <div class="section">Areas of Improvement</div>
      <div class="impact" id="areas"></div>

      <div class="section">Top Drivers by $ Impact</div>
      <div class="drivers" id="drivers"></div>

      <div class="disclaimer">These outputs are estimates based on user-provided inputs and model assumptions.</div>
    </div>
  </div>
  
  <footer>
    © 2025 Treblle — <a href="mailto:sales@treblle.com">sales@treblle.com</a>
  </footer>
</div>

<script>
(function(){
  const $ = id => document.getElementById(id);
  const sym = c => ({USD:"$",EUR:"€",GBP:"£",SEK:"kr",NOK:"kr"}[c]||"");
  const money = (v,c) => (Number.isFinite(v)? sym(c)+Number(v).toLocaleString(undefined,{maximumFractionDigits:0}) : "n/a");
  const num = v => (Number.isFinite(v)? Number(v).toLocaleString(): "n/a");

  const defaults = () => ({
    annualRequests:300000000, monthlyGrowth:10, numAPIs:25, numConsumers:1000,
    ticketsPerMonth:200, pctApiTickets:70, pctEscalated:30,
    hrsSupportPerTicket:0.5, hrsEngPerEscalation:1.0,
    rateSupport:45, rateEng:85,
    weeklyPatternHours:20, rateAnalytics:70, azureHours:40,
    customers:2000, arpa:1500, retentionRisk:1.0,
    complianceFTE:0, fteCost:120000, altTooling:0, devPortalSavings:0,
    confidence:80, deployment:"SaaS", override:"",
    commsHoursPerTicket:0.25, currency:"USD",
    bmSupport:68.7, bmEng:86.9, bmComms:94.2, bmAzure:90.0,
    pSaaSBase:35988, pSaaS25:10800, pPrivBase:71976, pPrivPerAPI:360
  });

  function read(){
    const val = id => {const el=$(id); if(!el) return 0; if(el.type==="number") return +el.value||0; return el.value;};
    return {
      company: $('company').value.trim(),
      annualRequests: val('annualRequests'),
      monthlyGrowth: val('monthlyGrowth'),
      numAPIs: val('numAPIs'),
      numConsumers: val('numConsumers'),
      ticketsPerMonth: val('ticketsPerMonth'),
      pctApiTickets: val('pctApiTickets'),
      pctEscalated: val('pctEscalated'),
      hrsSupportPerTicket: val('hrsSupportPerTicket'),
      hrsEngPerEscalation: val('hrsEngPerEscalation'),
      rateSupport: val('rateSupport'),
      rateEng: val('rateEng'),
      weeklyPatternHours: val('weeklyPatternHours'),
      rateAnalytics: val('rateAnalytics'),
      azureHours: val('azureHours'),
      customers: val('customers'),
      arpa: val('arpa'),
      retentionRisk: val('retentionRisk'),
      complianceFTE: val('complianceFTE'),
      fteCost: val('fteCost'),
      altTooling: val('altTooling'),
      devPortalSavings: val('devPortalSavings'),
      confidence: val('confidence'),
      deployment: $('deployment').value,
      override: (function(){const x=$('override').value.trim(); return x === "" ? "" : (+x || 0)})(),
      commsHoursPerTicket: val('commsHoursPerTicket'),
      currency: $('currency').value,
      bmSupport: val('bmSupport'),
      bmEng: val('bmEng'),
      bmComms: val('bmComms'),
      bmAzure: val('bmAzure'),
      pSaaSBase: val('pSaaSBase'),
      pSaaS25: val('pSaaS25'),
      pPrivBase: val('pPrivBase'),
      pPrivPerAPI: val('pPrivPerAPI')
    };
  }

  function calc(){
    const v = read();

    const apiTicketsMo = v.ticketsPerMonth * (v.pctApiTickets/100);
    const escalationsMo = apiTicketsMo * (v.pctEscalated/100);
    const annualSupportHrs = apiTicketsMo * v.hrsSupportPerTicket * 12;
    const annualEngHrs     = escalationsMo * v.hrsEngPerEscalation * 12;

    // After values for “areas”
    const supAfter = v.hrsSupportPerTicket * (1 - v.bmSupport/100);
    const engAfter = v.hrsEngPerEscalation * (1 - v.bmEng/100);
    const commsBefore = v.commsHoursPerTicket;
    const commsAfter  = v.commsHoursPerTicket * (v.bmComms>99.9 ? 0 : (1 - v.bmComms/100));
    const azureMonthlyAfter = v.azureHours * (v.bmAzure>99.9 ? 0 : (1 - v.bmAzure/100));
    const patternWeeklyAfter = 0; // fully reclaimed per model

    // Savings (annualized)
    const supportHrsSaved = annualSupportHrs * (v.bmSupport/100);
    const engHrsSaved     = annualEngHrs * (v.bmEng/100);
    const supportSavings  = supportHrsSaved * v.rateSupport;
    const engSavings      = engHrsSaved * v.rateEng;

    const commsHoursSaved = apiTicketsMo * v.commsHoursPerTicket * 12 * (v.bmComms/100);
    const commsSavings    = commsHoursSaved * v.rateSupport;

    const azureHoursSaved = v.azureHours * 12 * (v.bmAzure/100);
    const azureSavings    = azureHoursSaved * v.rateEng;

    const patternHoursSaved = v.weeklyPatternHours * 52;
    const patternSavings    = patternHoursSaved * v.rateAnalytics;

    const retentionSavings  = (v.retentionRisk/100) * v.customers * v.arpa;
    const complianceAvoid   = v.complianceFTE * v.fteCost;
    const altToolingAvoid   = v.altTooling;
    const devPortalSave     = v.devPortalSavings;

    const subtotal = supportSavings + engSavings + commsSavings + azureSavings + patternSavings + retentionSavings + complianceAvoid + altToolingAvoid + devPortalSave;
    const benefit = subtotal * (v.confidence/100);

    // Cost (override-first)
    let estCost = 0;
    let costNote = "";
    if (v.override !== "" && v.override > 0){
      estCost = v.override; costNote = "Override";
    } else if (v.deployment === "SaaS"){
      const base = v.pSaaSBase;
      const extraAPIs = Math.max(0, v.numAPIs - 25);
      const packs25 = extraAPIs === 0 ? 0 : Math.ceil(extraAPIs/25);
      estCost = base + packs25 * v.pSaaS25; costNote = `SaaS: base + ${packs25}×25-pack`;
    } else {
      const base = v.pPrivBase;
      const overAPIs = Math.max(0, v.numAPIs - 25);
      estCost = base + overAPIs * v.pPrivPerAPI; costNote = `Private: base + ${overAPIs} over-APIs`;
    }

    const net = benefit - estCost;
    const roi = estCost > 0 ? (net / estCost) : NaN;
    const paybackMonths = benefit > 0 ? (12 * estCost / benefit) : NaN;

    // KPIs
    $('outBenefit').textContent = money(benefit, v.currency);
    $('outCost').textContent    = money(estCost, v.currency);
    $('outNet').textContent     = money(net, v.currency);
    $('outROI').textContent     = (Number.isFinite(roi) ? roi.toFixed(2)+"x" : "n/a");
    $('outPaybackKPI').textContent = (Number.isFinite(paybackMonths) ? paybackMonths.toFixed(1) : "n/a");
    $('outConf').textContent    = Math.round(v.confidence) + "%";
    $('deploymentNote').textContent = costNote;
    const totalHoursSaved = supportHrsSaved + engHrsSaved + commsHoursSaved + azureHoursSaved + patternHoursSaved;
    $('hoursSaved').textContent = "Annual hours saved: " + num(Math.round(totalHoursSaved));

    // Areas of Improvement cards
    const areas = [
      {key:"support", title:"Support time per API ticket", before:v.hrsSupportPerTicket, after:supAfter, unit:"hrs", savings:supportSavings},
      {key:"eng", title:"Engineering time per escalated ticket", before:v.hrsEngPerEscalation, after:engAfter, unit:"hrs", savings:engSavings},
      {key:"comms", title:"Customer comms overhead per ticket", before:commsBefore, after:commsAfter, unit:"hrs", savings:commsSavings},
      {key:"azure", title:"Gateway/SQL manual query time (monthly)", before:v.azureHours, after:azureMonthlyAfter, unit:"hrs", savings:azureSavings},
      {key:"pattern", title:"Weekly pattern-analysis effort", before:v.weeklyPatternHours, after:patternWeeklyAfter, unit:"hrs", savings:patternSavings}
    ];
    const iconsMap = {
      support:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 8a6 6 0 1112 0v3a2 2 0 012 2v4a2 2 0 01-2 2h-2v-7h2V8a8 8 0 10-16 0v3h2v7H6a2 2 0 01-2-2v-4a2 2 0 012-2V8z"/></svg>`,
      eng:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 6v6l3 3"/><circle cx="12" cy="12" r="9"/></svg>`,
      comms:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M21 15a3 3 0 01-3 3H8l-5 3V6a3 3 0 013-3h12a3 3 0 013 3v9z"/></svg>`,
      azure:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="8"/><path d="M12 6v6l3 3"/></svg>`,
      pattern:`<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M4 17l6-6 4 4 6-6"/><path d="M4 7h16"/></svg>`
    };
    const areasEl = $('areas'); areasEl.innerHTML = "";
    areas.forEach(a=>{
      const r = a.before>0 ? 1-(a.after/a.before) : 0;
      const pctTxt = (r*100).toFixed(1)+"%";
      const el = document.createElement('div');
      el.className = "impactCard";
      el.innerHTML = `
        <div class="icon">${iconsMap[a.key]}</div>
        <div>
          <div class="impTitle">${a.title}</div>
          <div class="beforeAfter mono">${a.before.toFixed(2)} ${a.unit} → ${a.after.toFixed(2)} ${a.unit}</div>
          <div class="bar"><span style="width:${Math.max(0, Math.min(100, (r*100)))}%"></span></div>
        </div>
        <div>
          <div class="deltaPct">-${pctTxt}</div>
          <div class="deltaMoney mono">${money(a.savings, v.currency)} /yr</div>
        </div>`;
      areasEl.appendChild(el);
    });

    // Top drivers
    const drivers = [
      ["Support savings", supportSavings],
      ["Engineering savings", engSavings],
      ["Comms savings", commsSavings],
      ["Gateway/SQL savings", azureSavings],
      ["Pattern-analysis savings", patternSavings],
      ["Retention savings", retentionSavings],
      ["Compliance avoidance", complianceAvoid],
      ["Alt tooling avoided", altToolingAvoid],
      ["Dev portal savings", devPortalSave]
    ].sort((a,b)=>b[1]-a[1]).slice(0,3);

    const driversEl = $('drivers'); driversEl.innerHTML = "";
    drivers.forEach(([name,val],i)=>{
      const d = document.createElement('div');
      d.className = "driver";
      d.innerHTML = `<div class="name">#${i+1} ${name}</div><div class="amt mono">${money(val, v.currency)} /yr</div>`;
      driversEl.appendChild(d);
    });
  }

  function applyDefaults(){
    const d = defaults();
    for(const [k,v] of Object.entries(d)){
      const el = document.getElementById(k);
      if(!el) continue;
      el.value = v;
    }
  }

  $('recalcBtn').addEventListener('click', calc);
  $('resetBtn').addEventListener('click', ()=>{ applyDefaults(); calc(); });
  let t; document.addEventListener('input', ()=>{ clearTimeout(t); t=setTimeout(calc,80); });
  applyDefaults(); calc();
  
  // Debug video loading
  const video = document.querySelector('video');
  if (video) {
    console.log('Video element found');
    video.addEventListener('loadstart', () => console.log('Video: loadstart'));
    video.addEventListener('loadeddata', () => console.log('Video: loadeddata'));
    video.addEventListener('canplay', () => console.log('Video: canplay'));
    video.addEventListener('playing', () => console.log('Video: playing'));
    video.addEventListener('error', (e) => console.error('Video error:', e, video.error));
    video.addEventListener('stalled', () => console.warn('Video: stalled'));
  } else {
    console.error('Video element not found');
  }
})();
</script>
</body>
</html>

